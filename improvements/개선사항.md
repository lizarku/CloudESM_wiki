# 5. 개선사항

> **CloudESM SOAR 플랫폼 개선 계획 및 TODO 리스트**

[← 통합매뉴얼로 돌아가기](../통합매뉴얼.md)

---

## 목차
1. [성능 개선](#성능-개선)
2. [기능 개선](#기능-개선)
3. [데이터베이스 개선](#데이터베이스-개선)
   - [날짜/시간 컬럼 타입 정규화](#날짜시간-컬럼-타입-정규화)
4. [코드 품질](#코드-품질)
   - [VO/DTO 도입](#vodto-도입)
   - [DAO 레이어 역할 재정의](#dao-레이어-역할-재정의)
5. [보안 강화](#보안-강화)
   - [API 통신 보안](#api-통신-보안)
6. [운영 자동화](#운영-자동화)

---

## 데이터베이스 개선

### 날짜/시간 컬럼 타입 정규화

> **현재 상태**: 모든 날짜/시간 컬럼이 `VARCHAR`로 선언되어 있고, 포맷도 불일치

#### 현재 문제점

| 포맷 | 예시 | 사용처 |
|------|------|--------|
| `YYYYMMDD` (8자리) | `20251216` | eval_date, pwd_change_dt |
| `YYYYMMDDHHmmss` (14자리) | `20251216143052` | reg_dt, mod_dt |
| `YYYY-MM-DD` (10자리) | `2025-12-16` | 일부 레거시 |

#### 발생하는 문제

| 문제 | 설명 |
|------|------|
| **날짜 연산 불가** | `DATE_ADD()`, `DATEDIFF()` 등 사용 불가 |
| **정렬 오류** | 문자열 정렬 ≠ 날짜 정렬 |
| **타임존 미지원** | UTC 변환 불가 |
| **유효성 검증 없음** | `'99991399'`도 저장 가능 |

#### 개선 방안

```sql
-- 권장 스키마
CREATE TABLE example (
    reg_dt DATETIME DEFAULT CURRENT_TIMESTAMP,
    mod_dt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    eval_date DATE
);
```

---

## 코드 품질

### VO/DTO 도입

> **현재 상태**: 프로젝트 전체에서 `Map<String, Object>`만 사용, VO/DTO 클래스 부재

#### 문제점

- 타입 안전성 없음 (컴파일 시점 오류 검출 불가)
- IDE 자동완성 불가
- 필드명 오타 → 런타임 오류

### DAO 레이어 역할 재정의

> **현재 상태**: "DAO"라고 명명되어 있지만 실제로는 MyBatis Mapper Interface에 불과

#### 권장 아키텍처

```
Controller → Service → DAO → Mapper → DB
                        ↓       ↓
                       VO     Map
```

---

## 보안 강화

### API 통신 보안

> **현재 상태**: `$.ajax()` GET 방식과 `requestData()` POST 방식이 혼용되고 있음

#### GET 방식의 보안 취약점

| 취약점 | 설명 | 위험도 |
|--------|------|--------|
| **URL 파라미터 노출** | 브라우저 주소창, 북마크에 민감 정보 노출 | 높음 |
| **서버 로그 기록** | Access Log에 쿼리스트링 전체 기록됨 | 높음 |
| **브라우저 히스토리** | 뒤로가기/앞으로가기 시 민감 정보 재노출 | 중간 |

#### 현재 프로젝트의 혼용 현황

| 패턴 | 사용 횟수 | 보안 수준 |
|------|-----------|-----------|
| `$.ajax({ type: "GET" })` | 93회 (61개 파일) | ⚠️ 낮음 |
| `$("body").requestData()` | 442회 (380개 파일) | ✅ 높음 |

#### 개선 권장사항

**모든 API를 POST 방식으로 통일**

```javascript
// ❌ Before: GET 방식 (파라미터 노출)
$.ajax({
    type: "GET",
    url: "/api/search",
    data: { keyword: "민감정보" }
});

// ✅ After: POST 방식 (Body에 숨김)
$("body").requestData("/api/search", {
    slKey: $("#slKey").val(),
    keyword: "민감정보"
}, { callback: function(data) { ... } });
```

---

[← 통합매뉴얼로 돌아가기](../통합매뉴얼.md)

**작성일**: 2025-12-17 | **버전**: 1.1
